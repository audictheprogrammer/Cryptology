import sys
import operator
import string

ALPHABET = string.ascii_uppercase
alphabet = string.ascii_lowercase

def frequence(text):
    """ 
    str -> list[tuple[str,float]]
    Calcule la fréquence des caractères dans text.
    """
    FC=dict()
    nb=0
    for c in text:
        if c in FC:
            FC[c]+=1
        else:
            FC[c]=1
        nb+=1
    for c in FC:
        FC[c]/=nb
    return sorted(FC.items(), key=operator.itemgetter(1),reverse=True)

def frequence_bigrammes(text):
    """
    str -> dict[str:list[tuple[str,float]]]*dict[str:list[tuple[str,float]]]
    Calcule la fréquence des bigrammes dans text. 
    """
    DFBR=dict()
    nb=0
    for i in range(len(text)-1):
        if text[i] in DFBR:
            if text[i+1] in DFBR[text[i]]:
                DFBR[text[i]][text[i+1]]+=1
            else:
                DFBR[text[i]][text[i+1]]=1
        else:
            DFBR[text[i]]=dict()
            DFBR[text[i]][text[i+1]]=1
        nb+=1
    nb+=1
    DFBL=dict()
    for c in DFBR:
        for c2 in DFBR[c]:
            if c2 not in DFBL:
                DFBL[c2]=dict()
            DFBL[c2][c]=DFBR[c][c2]
    for c in DFBR:
        for c2 in DFBR[c]:
            DFBR[c][c2]/=nb
            DFBL[c2][c]/=nb
    DBL=dict()
    for c in DFBR:
        if c in DFBR[c]:
            DBL[c]=DFBR[c][c]
        else:
            DBL[c]=0
    LFBR=dict()
    for c in DFBR:
        LFBR[c]=sorted(DFBR[c].items(), key=operator.itemgetter(1),reverse=True)
    LFBL=dict()
    for c in DFBL:
        LFBL[c]=sorted(DFBL[c].items(), key=operator.itemgetter(1),reverse=True)
    return (DFBR,LFBR,LFBL,DBL)

# Texte de référence du français
Fref= [('e', 0.17174754258773295), ('a', 0.09213437454330574), ('s', 0.07816826681746844), ('i', 0.07507259453174145), ('t', 0.0737433362349966), ('n', 0.07030835996721332), ('r', 0.06609311162084369), ('u', 0.06356167517044624), ('l', 0.06136827190067416), ('o', 0.04914062053233872), ('d', 0.037536932666586184), ('c', 0.030178992381545422), ('m', 0.026498751437594118), ('p', 0.023697905083841123), ('v', 0.016450524523290613), ('f', 0.010939058717380115), ('h', 0.010717939268399616), ('g', 0.0106150043524949), ('b', 0.010354490059155806), ('q', 0.010160057440224678), ('x', 0.004071647784675406), ('j', 0.0038327371156619923), ('y', 0.0023001505899695645), ('z', 0.0012263233808401269), ('k', 6.989407870073262e-05), ('w', 1.1437212878301701e-05)]

DFBRref={'E': {'M': 0.00867957377320007, 'Z': 0.0008971858102312223, 'R': 0.015017060509210133, 'P': 0.006450588063362159, 'I': 0.0029037812696577096, 'S': 0.029219537301199, 'T': 0.015465653414325745, 'O': 0.0009073522216786016, 'E': 0.006524294546355659, 'U': 0.010041872907148893, 'N': 0.023098086808445745, 'D': 0.008744384646177111, 'C': 0.008660511751736233, 'B': 0.002502208017486228, 'V': 0.004398243752422465, 'L': 0.012583475768993716, 'H': 0.0008857485973529206, 'J': 0.0013025714666954715, 'A': 0.005346261619890584, 'G': 0.0022022988797885386, 'F': 0.0029940081712532007, 'Q': 0.0023128586042787886, 'X': 0.0005502570195894041, 'Y': 5.0832057236896447e-05, 'K': 6.354007154612056e-06, 'W': 1.2708014309224111e-06}, 'M': {'I': 0.0025225408403809864, 'M': 0.0026877450264008998, 'E': 0.008741843043315267, 'A': 0.00547588336584467, 'O': 0.002753826700808865, 'P': 0.0019544926007586685, 'B': 0.0013457787153468336, 'U': 0.0006137970911355246, 'T': 1.2708014309224112e-05, 'N': 2.5416028618448223e-05, 'D': 0.00012072613593762907, 'L': 2.6686830049370635e-05, 'H': 0.00011055972449024977, 'S': 2.7957631480293048e-05, 'J': 3.8124042927672336e-06, 'G': 3.812404292767234e-05, 'Q': 5.0832057236896445e-06, 'C': 1.5249617171068934e-05, 'Y': 1.1437212878301701e-05, 'R': 2.5416028618448222e-06, 'V': 2.5416028618448222e-06}, 'I': {'L': 0.010838665404337245, 'N': 0.008462266728512337, 'E': 0.011807016094700123, 'I': 0.00020205742751666338, 'D': 0.0017498935703801602, 'T': 0.01681397373253442, 'S': 0.009284475254319136, 'V': 0.001087806024869584, 'X': 0.0005972766725335333, 'R': 0.0048989395162058955, 'O': 0.001918910160692841, 'M': 0.0011894701393433769, 'Z': 4.9561255805974034e-05, 'G': 0.0011132220534880322, 'F': 0.00042190607506624055, 'H': 4.9561255805974034e-05, 'Q': 0.0007548560499679122, 'B': 0.0005782146510696971, 'C': 0.0012364897922875061, 'A': 0.0012733430337842561, 'U': 9.022690159549119e-05, 'P': 0.00047019652944129217, 'J': 0.0001817246046219048, 'Y': 2.5416028618448222e-06}, 'L': {'E': 0.02356828333788704, 'A': 0.015052642949275961, 'P': 0.0003024507405595339, 'L': 0.006934763408543598, 'O': 0.002864386425299115, 'U': 0.003099484690019761, 'N': 0.0006074430839809125, 'I': 0.002960967334049218, 'H': 0.00031007554914506833, 'M': 0.0002389106690134133, 'Q': 0.00027576391051016325, 'F': 0.00033422077633259417, 'C': 0.00035328279779643033, 'S': 0.00218196605689378, 'B': 0.00013216334881593076, 'D': 0.0006201510982901367, 'J': 4.829045437505163e-05, 'G': 0.00020332822894758579, 'T': 0.0003177003577306028, 'Y': 0.00038124042927672336, 'R': 0.0003520119963655079, 'Z': 6.099846868427574e-05, 'V': 0.00016647498745083587, 'K': 1.2708014309224111e-06}, 'Z': {'O': 3.812404292767234e-05, 'L': 0.0001461421645560773, 'S': 1.7791220032913757e-05, 'R': 4.0665645789517156e-05, 'E': 0.000157579377434379, 'A': 0.0002147654418258875, 'J': 1.2708014309224112e-05, 'U': 1.6520418601991345e-05, 'V': 0.0001232677387994739, 'I': 8.641449730272396e-05, 'D': 8.387289444087914e-05, 'N': 4.0665645789517156e-05, 'T': 3.049923434213787e-05, 'M': 7.497728442442226e-05, 'Q': 2.7957631480293048e-05, 'F': 5.0832057236896445e-06, 'P': 4.829045437505163e-05, 'C': 2.2874425756603402e-05, 'G': 1.1437212878301701e-05, 'B': 2.160362432568099e-05, 'H': 1.2708014309224111e-06, 'Y': 3.8124042927672336e-06}, 'O': {'L': 0.0014296516097877126, 'U': 0.015291553618289374, 'I': 0.005350074024183351, 'B': 0.00032151276202337006, 'M': 0.0037971546755961646, 'N': 0.012541539321773276, 'Y': 0.0006658999498033435, 'R': 0.004915459934807887, 'T': 0.0010928892305932737, 'C': 0.0007701056671389812, 'S': 0.0013178210838665405, 'F': 0.00017155819317452552, 'G': 0.0002160362432568099, 'E': 0.000271951506217396, 'H': 8.260209300995673e-05, 'K': 1.2708014309224112e-05, 'D': 0.00017155819317452552, 'P': 0.0005578818281749385, 'Q': 8.768529873364638e-05, 'J': 1.1437212878301701e-05, 'V': 5.210285866781886e-05, 'O': 7.624808585534467e-06, 'A': 3.8124042927672336e-06}, 'A': {'G': 0.002459000768834866, 'L': 0.00569700281482517, 'R': 0.007590496946899563, 'N': 0.012082780005210287, 'P': 0.003051194235644709, 'I': 0.0233166646545644, 'S': 0.005283992349775386, 'M': 0.0033015421175364244, 'V': 0.005478424968706515, 'T': 0.004309287652257896, 'F': 0.0014487136312515488, 'C': 0.004257184793590078, 'Y': 0.0004155520679116285, 'U': 0.006524294546355659, 'Q': 0.0009035398173858343, 'D': 0.0018693489048868669, 'B': 0.0019392429835875995, 'E': 0.0005782146510696971, 'H': 0.0009327682502970498, 'A': 0.0002960967334049218, 'J': 0.0002872011233884649, 'O': 8.133129157903431e-05, 'Z': 2.9228432911215456e-05, 'K': 1.2708014309224111e-06}, 'G': {'E': 0.0035035995450530878, 'R': 0.001894764933505315, 'L': 0.00042444767792808536, 'O': 0.0006328591125993608, 'N': 0.0010547651876656014, 'I': 0.0004155520679116285, 'A': 0.0014995456884884452, 'U': 0.0006747955598198004, 'T': 0.00021349464039496508, 'D': 8.895610016456878e-05, 'S': 6.73524758388878e-05, 'B': 3.8124042927672336e-06, 'M': 6.099846868427574e-05, 'G': 2.9228432911215456e-05, 'C': 1.5249617171068934e-05, 'P': 1.1437212878301701e-05, 'H': 8.895610016456878e-06, 'F': 1.0166411447379289e-05, 'J': 1.2708014309224111e-06, 'Q': 3.8124042927672336e-06}, 'R': {'M': 0.0013457787153468336, 'E': 0.021078783334710034, 'T': 0.0032303772374047694, 'A': 0.008519452792903845, 'I': 0.005614400721815213, 'D': 0.003553160800859062, 'O': 0.004748984947357051, 'C': 0.0017359147546400137, 'S': 0.004423659781040913, 'L': 0.003340936961895019, 'G': 0.000695128382714559, 'U': 0.0016787286902485053, 'B': 0.00047019652944129217, 'R': 0.0024081687115979694, 'Q': 0.0005146745795235765, 'N': 0.0010102871375833168, 'P': 0.0007561268513988347, 'V': 0.0004562177137011456, 'J': 0.0001258093416613187, 'F': 0.00021857784611865473, 'H': 0.00010547651876656014, 'Y': 3.43116386349051e-05, 'Z': 2.0332822894758578e-05, 'X': 2.5416028618448222e-06, 'W': 5.0832057236896445e-06}, 'N': {'A': 0.004501178668327181, 'S': 0.006469650084825996, 'E': 0.012489436463105458, 'U': 0.0011665957135867735, 'C': 0.004071647784675406, 'H': 0.0003393039820562838, 'D': 0.0064239012333127885, 'N': 0.003164295562996804, 'T': 0.017572642186795103, 'O': 0.002404356307305202, 'P': 0.0010179119461688514, 'G': 0.0019722838207915823, 'M': 0.0006887743755599469, 'I': 0.002024386679459401, 'F': 0.0013406955096231439, 'V': 0.0007929800928955845, 'L': 0.001211073763669058, 'Q': 0.0008387289444087914, 'Y': 0.00019443261893112892, 'J': 0.0003062631448523011, 'B': 0.0005121329766617317, 'R': 0.0006925867798527141, 'Z': 9.149770302641361e-05, 'X': 1.1437212878301701e-05, 'W': 2.5416028618448222e-06, 'K': 7.624808585534467e-06}, 'P': {'R': 0.002858032418144503, 'A': 0.006137970911355246, 'L': 0.0023586074557919953, 'S': 0.0005210285866781885, 'E': 0.004112313430464923, 'O': 0.0039115268043791816, 'U': 0.001245385402303963, 'I': 0.0010903476277314289, 'P': 0.0006620875455105763, 'T': 0.0002795763148029305, 'H': 0.00019189101606928408, 'D': 0.00016520418601991346, 'B': 2.160362432568099e-05, 'C': 5.337366009874127e-05, 'Q': 1.5249617171068934e-05, 'M': 1.7791220032913757e-05, 'N': 3.8124042927672336e-06, 'V': 7.624808585534467e-06, 'G': 2.160362432568099e-05, 'F': 1.6520418601991345e-05, 'J': 6.354007154612056e-06}, 'T': {'I': 0.006258697047292875, 'S': 0.00423176876497163, 'O': 0.004033523741747733, 'E': 0.014639632484226178, 'D': 0.005694461211963325, 'R': 0.007078363970237831, 'T': 0.0036700745325039235, 'A': 0.009726714152280136, 'L': 0.005276367541189851, 'M': 0.001057306790527446, 'Q': 0.0014169435954784885, 'U': 0.002404356307305202, 'P': 0.0028567616167135806, 'N': 0.00033294997490167173, 'B': 0.000559152629605861, 'C': 0.0022569433413182024, 'F': 0.0005324657995564903, 'V': 0.0005045081680761972, 'G': 0.00025797269047724946, 'J': 0.00034438718777997346, 'H': 0.0005515278210203265, 'Z': 2.6686830049370635e-05, 'Y': 3.177003577306028e-05}, 'D': {'A': 0.004600301179939129, 'U': 0.0037132817811552856, 'E': 0.021142323406256155, 'I': 0.003166837165858649, 'R': 0.0012809678423697905, 'D': 0.0003049923434213787, 'O': 0.0019506801964659013, 'S': 0.0005172161823854214, 'H': 0.00022111944898049954, 'V': 2.4145227187525814e-05, 'C': 0.00010293491590471531, 'T': 3.049923434213787e-05, 'L': 0.00014232976026331006, 'Q': 3.5582440065827514e-05, 'N': 2.2874425756603402e-05, 'P': 7.751888728626708e-05, 'J': 4.0665645789517156e-05, 'Y': 2.0332822894758578e-05, 'F': 3.049923434213787e-05, 'M': 8.641449730272396e-05, 'Z': 3.8124042927672336e-06, 'G': 1.3978815740146524e-05, 'B': 7.624808585534467e-06}, 'S': {'L': 0.00451134507977456, 'E': 0.014105895883238765, 'O': 0.005752918077785755, 'A': 0.009142145494055827, 'D': 0.005611859118953368, 'C': 0.003850528335694906, 'S': 0.007758242735781321, 'U': 0.003208773613079088, 'R': 0.0012428437994421182, 'N': 0.0009073522216786016, 'T': 0.0043677445180803276, 'V': 0.0008679573773200069, 'I': 0.004774400975975499, 'F': 0.001158970905001239, 'P': 0.0030486526327828645, 'M': 0.0018655365005940997, 'G': 0.0007980632986192743, 'Q': 0.0024335847402164176, 'B': 0.0011399088835374028, 'H': 0.0006595459426487314, 'J': 0.0005578818281749385, 'Y': 0.0003736156206911889, 'Z': 1.2708014309224112e-05, 'K': 1.3978815740146524e-05, 'W': 2.5416028618448222e-06, 'X': 1.2708014309224111e-06}, 'U': {'S': 0.0060007243568156255, 'I': 0.00758922614546864, 'N': 0.006829286889777038, 'R': 0.010518423443744797, 'L': 0.002779242729427313, 'T': 0.005440300925778843, 'D': 0.0016545834630609794, 'P': 0.00197101301936066, 'E': 0.0070199071044154, 'F': 0.0009213310374187482, 'V': 0.0023713154701012194, 'C': 0.0016342506401662209, 'M': 0.000988683513257636, 'G': 0.000494341756628818, 'X': 0.0029025104682267873, 'J': 0.0004829045437505163, 'B': 0.0005261117924018783, 'U': 0.0003316791734707493, 'O': 0.0006290467083065936, 'A': 0.0019290765721402202, 'Q': 0.00037869882641487854, 'Z': 2.9228432911215456e-05, 'H': 6.099846868427574e-05, 'Y': 7.87896887171895e-05}, 'B': {'S': 0.00014360056169423246, 'E': 0.0016202718244260742, 'A': 0.001702873917436031, 'R': 0.0016774578888175827, 'O': 0.002283630171367573, 'U': 0.00029990913769768903, 'I': 0.0008971858102312223, 'L': 0.001668562278801126, 'J': 5.0832057236896445e-06, 'M': 5.0832057236896445e-06, 'T': 2.7957631480293048e-05, 'D': 2.5416028618448222e-06, 'B': 1.6520418601991345e-05, 'N': 1.2708014309224111e-06, 'Q': 2.5416028618448222e-06}, 'C': {'U': 0.00121742777082367, 'R': 0.001668562278801126, 'H': 0.006036306796881453, 'O': 0.00664629148372421, 'E': 0.006858515322688254, 'I': 0.00139661077258373, 'L': 0.0010090163361523945, 'T': 0.0005731314453460074, 'A': 0.003438788672076045, 'S': 0.0002795763148029305, 'C': 0.0006366715168921281, 'D': 0.00016393338458899106, 'F': 1.3978815740146524e-05, 'Z': 3.8124042927672336e-06, 'P': 5.845686582243091e-05, 'B': 2.4145227187525814e-05, 'N': 2.160362432568099e-05, 'V': 2.4145227187525814e-05, 'M': 4.829045437505163e-05, 'Q': 2.7957631480293048e-05, 'K': 1.1437212878301701e-05, 'J': 1.6520418601991345e-05, 'G': 3.8124042927672336e-06}, 'H': {'O': 0.0014703172555772298, 'I': 0.000623963502582904, 'A': 0.0032125860173718556, 'E': 0.004682903272949086, 'U': 0.00039903164930963714, 'C': 4.0665645789517156e-05, 'R': 5.5915262960586095e-05, 'B': 5.337366009874127e-05, 'L': 2.4145227187525814e-05, 'N': 2.6686830049370635e-05, 'T': 1.1437212878301701e-05, 'Q': 5.0832057236896445e-06, 'Y': 1.7791220032913757e-05, 'V': 7.624808585534467e-06, 'P': 5.0832057236896445e-06, 'M': 3.177003577306028e-05, 'S': 1.906202146383617e-05, 'J': 2.0332822894758578e-05, 'F': 2.5416028618448222e-06, 'D': 3.8124042927672336e-06, 'K': 2.5416028618448222e-06, 'G': 1.2708014309224111e-06}, 'V': {'A': 0.005460633748673601, 'E': 0.0047909213945774905, 'O': 0.003056277441368399, 'I': 0.002048531906646927, 'R': 0.0009086230231095241, 'U': 0.000157579377434379, 'Y': 1.2708014309224111e-06, 'L': 1.2708014309224112e-05, 'M': 2.5416028618448222e-06, 'C': 2.5416028618448222e-06, 'V': 6.354007154612056e-06, 'Q': 1.2708014309224111e-06, 'D': 1.2708014309224111e-06}, 'X': {'K': 1.2708014309224112e-05, 'H': 0.0001385173559705428, 'L': 0.00021349464039496508, 'M': 0.0002833887190956977, 'R': 7.497728442442226e-05, 'D': 0.0003901360392931802, 'S': 0.00020968223610219784, 'T': 0.0002274734561351116, 'C': 0.00039394844358594746, 'G': 7.370648299349985e-05, 'I': 0.00018426620748374962, 'B': 0.00017282899460544792, 'E': 0.00039394844358594746, 'U': 3.5582440065827514e-05, 'A': 0.0003901360392931802, 'F': 0.00016520418601991346, 'P': 0.0003469287906418183, 'N': 6.481087297704297e-05, 'O': 5.9727667253353325e-05, 'Q': 0.00011055972449024977, 'J': 6.86232772698102e-05, 'V': 5.337366009874127e-05, 'Y': 6.354007154612056e-06, 'Z': 1.2708014309224111e-06}, 'K': {'I': 3.5582440065827514e-05, 'E': 1.7791220032913757e-05, 'D': 6.354007154612056e-06, 'A': 7.624808585534467e-06, 'O': 1.2708014309224111e-06, 'L': 1.2708014309224111e-06}, 'Y': {'A': 0.0009594550803464205, 'E': 0.0007980632986192743, 'S': 0.0001232677387994739, 'R': 5.337366009874127e-05, 'C': 3.304083720398269e-05, 'D': 8.133129157903431e-05, 'O': 7.116488013165503e-05, 'P': 3.812404292767234e-05, 'G': 6.354007154612056e-06, 'V': 2.160362432568099e-05, 'T': 4.9561255805974034e-05, 'H': 1.2708014309224111e-06, 'M': 1.7791220032913757e-05, 'X': 6.354007154612056e-06, 'F': 1.1437212878301701e-05, 'L': 1.5249617171068934e-05, 'J': 1.2708014309224111e-06, 'N': 5.0832057236896445e-06, 'B': 3.8124042927672336e-06, 'I': 1.2708014309224111e-06, 'U': 1.2708014309224111e-06}, 'Q': {'U': 0.010032977297132437, 'O': 5.0832057236896445e-06, 'A': 1.7791220032913757e-05, 'M': 2.4145227187525814e-05, 'P': 7.624808585534467e-06, 'J': 2.5416028618448222e-06, 'C': 2.9228432911215456e-05, 'E': 3.8124042927672336e-06, 'D': 2.5416028618448222e-06, 'F': 6.354007154612056e-06, 'S': 7.624808585534467e-06, 'H': 1.3978815740146524e-05, 'T': 1.2708014309224111e-06, 'G': 3.8124042927672336e-06, 'B': 1.2708014309224111e-06}, 'F': {'F': 0.0011348256778137133, 'L': 0.000723086014194852, 'A': 0.002391648292995978, 'O': 0.0018769737134724013, 'R': 0.0008628741715963173, 'E': 0.0014232976026331006, 'U': 0.0007713764685699036, 'I': 0.001603751405824083, 'C': 6.354007154612056e-06, 'D': 2.7957631480293048e-05, 'S': 6.226927011519815e-05, 'B': 1.2708014309224111e-06, 'V': 3.8124042927672336e-06, 'N': 5.0832057236896445e-06, 'M': 5.0832057236896445e-06, 'H': 1.6520418601991345e-05, 'Q': 7.624808585534467e-06, 'T': 5.0832057236896445e-06, 'J': 5.0832057236896445e-06, 'P': 5.0832057236896445e-06}, 'J': {'E': 0.0014156727940475662, 'O': 0.0010344323647708427, 'A': 0.0008260209300995673, 'U': 0.0005451738138657144, 'I': 1.2708014309224111e-06, 'Y': 1.0166411447379289e-05}, 'W': {'A': 7.624808585534467e-06, 'I': 3.8124042927672336e-06}}

FBRref= {'e': [('s', 0.029219537301199), ('n', 0.023098086808445745), ('t', 0.015465653414325745), ('r', 0.015017060509210133), ('l', 0.012583475768993716), ('u', 0.010041872907148893), ('d', 0.008744384646177111), ('m', 0.00867957377320007), ('c', 0.008660511751736233), ('e', 0.006524294546355659), ('p', 0.006450588063362159), ('a', 0.005346261619890584), ('v', 0.004398243752422465), ('f', 0.0029940081712532007), ('i', 0.0029037812696577096), ('b', 0.002502208017486228), ('q', 0.0023128586042787886), ('g', 0.0022022988797885386), ('j', 0.0013025714666954715), ('o', 0.0009073522216786016), ('z', 0.0008971858102312223), ('h', 0.0008857485973529206), ('x', 0.0005502570195894041), ('y', 5.0832057236896447e-05), ('k', 6.354007154612056e-06), ('w', 1.2708014309224111e-06)], 'm': [('e', 0.008741843043315267), ('a', 0.00547588336584467), ('o', 0.002753826700808865), ('m', 0.0026877450264008998), ('i', 0.0025225408403809864), ('p', 0.0019544926007586685), ('b', 0.0013457787153468336), ('u', 0.0006137970911355246), ('d', 0.00012072613593762907), ('h', 0.00011055972449024977), ('g', 3.812404292767234e-05), ('s', 2.7957631480293048e-05), ('l', 2.6686830049370635e-05), ('n', 2.5416028618448223e-05), ('c', 1.5249617171068934e-05), ('t', 1.2708014309224112e-05), ('y', 1.1437212878301701e-05), ('q', 5.0832057236896445e-06), ('j', 3.8124042927672336e-06), ('r', 2.5416028618448222e-06), ('v', 2.5416028618448222e-06)], 'i': [('t', 0.01681397373253442), ('e', 0.011807016094700123), ('l', 0.010838665404337245), ('s', 0.009284475254319136), ('n', 0.008462266728512337), ('r', 0.0048989395162058955), ('o', 0.001918910160692841), ('d', 0.0017498935703801602), ('a', 0.0012733430337842561), ('c', 0.0012364897922875061), ('m', 0.0011894701393433769), ('g', 0.0011132220534880322), ('v', 0.001087806024869584), ('q', 0.0007548560499679122), ('x', 0.0005972766725335333), ('b', 0.0005782146510696971), ('p', 0.00047019652944129217), ('f', 0.00042190607506624055), ('i', 0.00020205742751666338), ('j', 0.0001817246046219048), ('u', 9.022690159549119e-05), ('z', 4.9561255805974034e-05), ('h', 4.9561255805974034e-05), ('y', 2.5416028618448222e-06)], 'l': [('e', 0.02356828333788704), ('a', 0.015052642949275961), ('l', 0.006934763408543598), ('u', 0.003099484690019761), ('i', 0.002960967334049218), ('o', 0.002864386425299115), ('s', 0.00218196605689378), ('d', 0.0006201510982901367), ('n', 0.0006074430839809125), ('y', 0.00038124042927672336), ('c', 0.00035328279779643033), ('r', 0.0003520119963655079), ('f', 0.00033422077633259417), ('t', 0.0003177003577306028), ('h', 0.00031007554914506833), ('p', 0.0003024507405595339), ('q', 0.00027576391051016325), ('m', 0.0002389106690134133), ('g', 0.00020332822894758579), ('v', 0.00016647498745083587), ('b', 0.00013216334881593076), ('z', 6.099846868427574e-05), ('j', 4.829045437505163e-05), ('k', 1.2708014309224111e-06)], 'z': [('a', 0.0002147654418258875), ('e', 0.000157579377434379), ('l', 0.0001461421645560773), ('v', 0.0001232677387994739), ('i', 8.641449730272396e-05), ('d', 8.387289444087914e-05), ('m', 7.497728442442226e-05), ('p', 4.829045437505163e-05), ('r', 4.0665645789517156e-05), ('n', 4.0665645789517156e-05), ('o', 3.812404292767234e-05), ('t', 3.049923434213787e-05), ('q', 2.7957631480293048e-05), ('c', 2.2874425756603402e-05), ('b', 2.160362432568099e-05), ('s', 1.7791220032913757e-05), ('u', 1.6520418601991345e-05), ('j', 1.2708014309224112e-05), ('g', 1.1437212878301701e-05), ('f', 5.0832057236896445e-06), ('y', 3.8124042927672336e-06), ('h', 1.2708014309224111e-06)], 'o': [('u', 0.015291553618289374), ('n', 0.012541539321773276), ('i', 0.005350074024183351), ('r', 0.004915459934807887), ('m', 0.0037971546755961646), ('l', 0.0014296516097877126), ('s', 0.0013178210838665405), ('t', 0.0010928892305932737), ('c', 0.0007701056671389812), ('y', 0.0006658999498033435), ('p', 0.0005578818281749385), ('b', 0.00032151276202337006), ('e', 0.000271951506217396), ('g', 0.0002160362432568099), ('f', 0.00017155819317452552), ('d', 0.00017155819317452552), ('q', 8.768529873364638e-05), ('h', 8.260209300995673e-05), ('v', 5.210285866781886e-05), ('k', 1.2708014309224112e-05), ('j', 1.1437212878301701e-05), ('o', 7.624808585534467e-06), ('a', 3.8124042927672336e-06)], 'a': [('i', 0.0233166646545644), ('n', 0.012082780005210287), ('r', 0.007590496946899563), ('u', 0.006524294546355659), ('l', 0.00569700281482517), ('v', 0.005478424968706515), ('s', 0.005283992349775386), ('t', 0.004309287652257896), ('c', 0.004257184793590078), ('m', 0.0033015421175364244), ('p', 0.003051194235644709), ('g', 0.002459000768834866), ('b', 0.0019392429835875995), ('d', 0.0018693489048868669), ('f', 0.0014487136312515488), ('h', 0.0009327682502970498), ('q', 0.0009035398173858343), ('e', 0.0005782146510696971), ('y', 0.0004155520679116285), ('a', 0.0002960967334049218), ('j', 0.0002872011233884649), ('o', 8.133129157903431e-05), ('z', 2.9228432911215456e-05), ('k', 1.2708014309224111e-06)], 'g': [('e', 0.0035035995450530878), ('r', 0.001894764933505315), ('a', 0.0014995456884884452), ('n', 0.0010547651876656014), ('u', 0.0006747955598198004), ('o', 0.0006328591125993608), ('l', 0.00042444767792808536), ('i', 0.0004155520679116285), ('t', 0.00021349464039496508), ('d', 8.895610016456878e-05), ('s', 6.73524758388878e-05), ('m', 6.099846868427574e-05), ('g', 2.9228432911215456e-05), ('c', 1.5249617171068934e-05), ('p', 1.1437212878301701e-05), ('f', 1.0166411447379289e-05), ('h', 8.895610016456878e-06), ('b', 3.8124042927672336e-06), ('q', 3.8124042927672336e-06), ('j', 1.2708014309224111e-06)], 'r': [('e', 0.021078783334710034), ('a', 0.008519452792903845), ('i', 0.005614400721815213), ('o', 0.004748984947357051), ('s', 0.004423659781040913), ('d', 0.003553160800859062), ('l', 0.003340936961895019), ('t', 0.0032303772374047694), ('r', 0.0024081687115979694), ('c', 0.0017359147546400137), ('u', 0.0016787286902485053), ('m', 0.0013457787153468336), ('n', 0.0010102871375833168), ('p', 0.0007561268513988347), ('g', 0.000695128382714559), ('q', 0.0005146745795235765), ('b', 0.00047019652944129217), ('v', 0.0004562177137011456), ('f', 0.00021857784611865473), ('j', 0.0001258093416613187), ('h', 0.00010547651876656014), ('y', 3.43116386349051e-05), ('z', 2.0332822894758578e-05), ('w', 5.0832057236896445e-06), ('x', 2.5416028618448222e-06)], 'n': [('t', 0.017572642186795103), ('e', 0.012489436463105458), ('s', 0.006469650084825996), ('d', 0.0064239012333127885), ('a', 0.004501178668327181), ('c', 0.004071647784675406), ('n', 0.003164295562996804), ('o', 0.002404356307305202), ('i', 0.002024386679459401), ('g', 0.0019722838207915823), ('f', 0.0013406955096231439), ('l', 0.001211073763669058), ('u', 0.0011665957135867735), ('p', 0.0010179119461688514), ('q', 0.0008387289444087914), ('v', 0.0007929800928955845), ('r', 0.0006925867798527141), ('m', 0.0006887743755599469), ('b', 0.0005121329766617317), ('h', 0.0003393039820562838), ('j', 0.0003062631448523011), ('y', 0.00019443261893112892), ('z', 9.149770302641361e-05), ('x', 1.1437212878301701e-05), ('k', 7.624808585534467e-06), ('w', 2.5416028618448222e-06)], 'p': [('a', 0.006137970911355246), ('e', 0.004112313430464923), ('o', 0.0039115268043791816), ('r', 0.002858032418144503), ('l', 0.0023586074557919953), ('u', 0.001245385402303963), ('i', 0.0010903476277314289), ('p', 0.0006620875455105763), ('s', 0.0005210285866781885), ('t', 0.0002795763148029305), ('h', 0.00019189101606928408), ('d', 0.00016520418601991346), ('c', 5.337366009874127e-05), ('b', 2.160362432568099e-05), ('g', 2.160362432568099e-05), ('m', 1.7791220032913757e-05), ('f', 1.6520418601991345e-05), ('q', 1.5249617171068934e-05), ('v', 7.624808585534467e-06), ('j', 6.354007154612056e-06), ('n', 3.8124042927672336e-06)], 't': [('e', 0.014639632484226178), ('a', 0.009726714152280136), ('r', 0.007078363970237831), ('i', 0.006258697047292875), ('d', 0.005694461211963325), ('l', 0.005276367541189851), ('s', 0.00423176876497163), ('o', 0.004033523741747733), ('t', 0.0036700745325039235), ('p', 0.0028567616167135806), ('u', 0.002404356307305202), ('c', 0.0022569433413182024), ('q', 0.0014169435954784885), ('m', 0.001057306790527446), ('b', 0.000559152629605861), ('h', 0.0005515278210203265), ('f', 0.0005324657995564903), ('v', 0.0005045081680761972), ('j', 0.00034438718777997346), ('n', 0.00033294997490167173), ('g', 0.00025797269047724946), ('y', 3.177003577306028e-05), ('z', 2.6686830049370635e-05)], 'd': [('e', 0.021142323406256155), ('a', 0.004600301179939129), ('u', 0.0037132817811552856), ('i', 0.003166837165858649), ('o', 0.0019506801964659013), ('r', 0.0012809678423697905), ('s', 0.0005172161823854214), ('d', 0.0003049923434213787), ('h', 0.00022111944898049954), ('l', 0.00014232976026331006), ('c', 0.00010293491590471531), ('m', 8.641449730272396e-05), ('p', 7.751888728626708e-05), ('j', 4.0665645789517156e-05), ('q', 3.5582440065827514e-05), ('t', 3.049923434213787e-05), ('f', 3.049923434213787e-05), ('v', 2.4145227187525814e-05), ('n', 2.2874425756603402e-05), ('y', 2.0332822894758578e-05), ('g', 1.3978815740146524e-05), ('b', 7.624808585534467e-06), ('z', 3.8124042927672336e-06)], 's': [('e', 0.014105895883238765), ('a', 0.009142145494055827), ('s', 0.007758242735781321), ('o', 0.005752918077785755), ('d', 0.005611859118953368), ('i', 0.004774400975975499), ('l', 0.00451134507977456), ('t', 0.0043677445180803276), ('c', 0.003850528335694906), ('u', 0.003208773613079088), ('p', 0.0030486526327828645), ('q', 0.0024335847402164176), ('m', 0.0018655365005940997), ('r', 0.0012428437994421182), ('f', 0.001158970905001239), ('b', 0.0011399088835374028), ('n', 0.0009073522216786016), ('v', 0.0008679573773200069), ('g', 0.0007980632986192743), ('h', 0.0006595459426487314), ('j', 0.0005578818281749385), ('y', 0.0003736156206911889), ('k', 1.3978815740146524e-05), ('z', 1.2708014309224112e-05), ('w', 2.5416028618448222e-06), ('x', 1.2708014309224111e-06)], 'u': [('r', 0.010518423443744797), ('i', 0.00758922614546864), ('e', 0.0070199071044154), ('n', 0.006829286889777038), ('s', 0.0060007243568156255), ('t', 0.005440300925778843), ('x', 0.0029025104682267873), ('l', 0.002779242729427313), ('v', 0.0023713154701012194), ('p', 0.00197101301936066), ('a', 0.0019290765721402202), ('d', 0.0016545834630609794), ('c', 0.0016342506401662209), ('m', 0.000988683513257636), ('f', 0.0009213310374187482), ('o', 0.0006290467083065936), ('b', 0.0005261117924018783), ('g', 0.000494341756628818), ('j', 0.0004829045437505163), ('q', 0.00037869882641487854), ('u', 0.0003316791734707493), ('y', 7.87896887171895e-05), ('h', 6.099846868427574e-05), ('z', 2.9228432911215456e-05)], 'b': [('o', 0.002283630171367573), ('a', 0.001702873917436031), ('r', 0.0016774578888175827), ('l', 0.001668562278801126), ('e', 0.0016202718244260742), ('i', 0.0008971858102312223), ('u', 0.00029990913769768903), ('s', 0.00014360056169423246), ('t', 2.7957631480293048e-05), ('b', 1.6520418601991345e-05), ('j', 5.0832057236896445e-06), ('m', 5.0832057236896445e-06), ('d', 2.5416028618448222e-06), ('q', 2.5416028618448222e-06), ('n', 1.2708014309224111e-06)], 'c': [('e', 0.006858515322688254), ('o', 0.00664629148372421), ('h', 0.006036306796881453), ('a', 0.003438788672076045), ('r', 0.001668562278801126), ('i', 0.00139661077258373), ('u', 0.00121742777082367), ('l', 0.0010090163361523945), ('c', 0.0006366715168921281), ('t', 0.0005731314453460074), ('s', 0.0002795763148029305), ('d', 0.00016393338458899106), ('p', 5.845686582243091e-05), ('m', 4.829045437505163e-05), ('q', 2.7957631480293048e-05), ('b', 2.4145227187525814e-05), ('v', 2.4145227187525814e-05), ('n', 2.160362432568099e-05), ('j', 1.6520418601991345e-05), ('f', 1.3978815740146524e-05), ('k', 1.1437212878301701e-05), ('z', 3.8124042927672336e-06), ('g', 3.8124042927672336e-06)], 'h': [('e', 0.004682903272949086), ('a', 0.0032125860173718556), ('o', 0.0014703172555772298), ('i', 0.000623963502582904), ('u', 0.00039903164930963714), ('r', 5.5915262960586095e-05), ('b', 5.337366009874127e-05), ('c', 4.0665645789517156e-05), ('m', 3.177003577306028e-05), ('n', 2.6686830049370635e-05), ('l', 2.4145227187525814e-05), ('j', 2.0332822894758578e-05), ('s', 1.906202146383617e-05), ('y', 1.7791220032913757e-05), ('t', 1.1437212878301701e-05), ('v', 7.624808585534467e-06), ('q', 5.0832057236896445e-06), ('p', 5.0832057236896445e-06), ('d', 3.8124042927672336e-06), ('f', 2.5416028618448222e-06), ('k', 2.5416028618448222e-06), ('g', 1.2708014309224111e-06)], 'v': [('a', 0.005460633748673601), ('e', 0.0047909213945774905), ('o', 0.003056277441368399), ('i', 0.002048531906646927), ('r', 0.0009086230231095241), ('u', 0.000157579377434379), ('l', 1.2708014309224112e-05), ('v', 6.354007154612056e-06), ('m', 2.5416028618448222e-06), ('c', 2.5416028618448222e-06), ('y', 1.2708014309224111e-06), ('q', 1.2708014309224111e-06), ('d', 1.2708014309224111e-06)], 'x': [('c', 0.00039394844358594746), ('e', 0.00039394844358594746), ('d', 0.0003901360392931802), ('a', 0.0003901360392931802), ('p', 0.0003469287906418183), ('m', 0.0002833887190956977), ('t', 0.0002274734561351116), ('l', 0.00021349464039496508), ('s', 0.00020968223610219784), ('i', 0.00018426620748374962), ('b', 0.00017282899460544792), ('f', 0.00016520418601991346), ('h', 0.0001385173559705428), ('q', 0.00011055972449024977), ('r', 7.497728442442226e-05), ('g', 7.370648299349985e-05), ('j', 6.86232772698102e-05), ('n', 6.481087297704297e-05), ('o', 5.9727667253353325e-05), ('v', 5.337366009874127e-05), ('u', 3.5582440065827514e-05), ('k', 1.2708014309224112e-05), ('y', 6.354007154612056e-06), ('z', 1.2708014309224111e-06)], 'k': [('i', 3.5582440065827514e-05), ('e', 1.7791220032913757e-05), ('a', 7.624808585534467e-06), ('d', 6.354007154612056e-06), ('o', 1.2708014309224111e-06), ('l', 1.2708014309224111e-06)], 'y': [('a', 0.0009594550803464205), ('e', 0.0007980632986192743), ('s', 0.0001232677387994739), ('d', 8.133129157903431e-05), ('o', 7.116488013165503e-05), ('r', 5.337366009874127e-05), ('t', 4.9561255805974034e-05), ('p', 3.812404292767234e-05), ('c', 3.304083720398269e-05), ('v', 2.160362432568099e-05), ('m', 1.7791220032913757e-05), ('l', 1.5249617171068934e-05), ('f', 1.1437212878301701e-05), ('g', 6.354007154612056e-06), ('x', 6.354007154612056e-06), ('n', 5.0832057236896445e-06), ('b', 3.8124042927672336e-06), ('h', 1.2708014309224111e-06), ('j', 1.2708014309224111e-06), ('i', 1.2708014309224111e-06), ('u', 1.2708014309224111e-06)], 'q': [('u', 0.010032977297132437), ('c', 2.9228432911215456e-05), ('m', 2.4145227187525814e-05), ('a', 1.7791220032913757e-05), ('h', 1.3978815740146524e-05), ('p', 7.624808585534467e-06), ('s', 7.624808585534467e-06), ('f', 6.354007154612056e-06), ('o', 5.0832057236896445e-06), ('e', 3.8124042927672336e-06), ('g', 3.8124042927672336e-06), ('j', 2.5416028618448222e-06), ('d', 2.5416028618448222e-06), ('t', 1.2708014309224111e-06), ('b', 1.2708014309224111e-06)], 'f': [('a', 0.002391648292995978), ('o', 0.0018769737134724013), ('i', 0.001603751405824083), ('e', 0.0014232976026331006), ('f', 0.0011348256778137133), ('r', 0.0008628741715963173), ('u', 0.0007713764685699036), ('l', 0.000723086014194852), ('s', 6.226927011519815e-05), ('d', 2.7957631480293048e-05), ('h', 1.6520418601991345e-05), ('q', 7.624808585534467e-06), ('c', 6.354007154612056e-06), ('n', 5.0832057236896445e-06), ('m', 5.0832057236896445e-06), ('t', 5.0832057236896445e-06), ('j', 5.0832057236896445e-06), ('p', 5.0832057236896445e-06), ('v', 3.8124042927672336e-06), ('b', 1.2708014309224111e-06)], 'j': [('e', 0.0014156727940475662), ('o', 0.0010344323647708427), ('a', 0.0008260209300995673), ('u', 0.0005451738138657144), ('y', 1.0166411447379289e-05), ('i', 1.2708014309224111e-06)], 'w': [('a', 7.624808585534467e-06), ('i', 3.8124042927672336e-06)]}

FBLref= {'m': [('e', 0.00867957377320007), ('o', 0.0037971546755961646), ('a', 0.0033015421175364244), ('m', 0.0026877450264008998), ('s', 0.0018655365005940997), ('r', 0.0013457787153468336), ('i', 0.0011894701393433769), ('t', 0.001057306790527446), ('u', 0.000988683513257636), ('n', 0.0006887743755599469), ('x', 0.0002833887190956977), ('l', 0.0002389106690134133), ('d', 8.641449730272396e-05), ('z', 7.497728442442226e-05), ('g', 6.099846868427574e-05), ('c', 4.829045437505163e-05), ('h', 3.177003577306028e-05), ('q', 2.4145227187525814e-05), ('p', 1.7791220032913757e-05), ('y', 1.7791220032913757e-05), ('b', 5.0832057236896445e-06), ('f', 5.0832057236896445e-06), ('v', 2.5416028618448222e-06)], 'z': [('e', 0.0008971858102312223), ('n', 9.149770302641361e-05), ('l', 6.099846868427574e-05), ('i', 4.9561255805974034e-05), ('a', 2.9228432911215456e-05), ('u', 2.9228432911215456e-05), ('t', 2.6686830049370635e-05), ('r', 2.0332822894758578e-05), ('s', 1.2708014309224112e-05), ('d', 3.8124042927672336e-06), ('c', 3.8124042927672336e-06), ('x', 1.2708014309224111e-06)], 'r': [('e', 0.015017060509210133), ('u', 0.010518423443744797), ('a', 0.007590496946899563), ('t', 0.007078363970237831), ('o', 0.004915459934807887), ('i', 0.0048989395162058955), ('p', 0.002858032418144503), ('r', 0.0024081687115979694), ('g', 0.001894764933505315), ('b', 0.0016774578888175827), ('c', 0.001668562278801126), ('d', 0.0012809678423697905), ('s', 0.0012428437994421182), ('v', 0.0009086230231095241), ('f', 0.0008628741715963173), ('n', 0.0006925867798527141), ('l', 0.0003520119963655079), ('x', 7.497728442442226e-05), ('h', 5.5915262960586095e-05), ('y', 5.337366009874127e-05), ('z', 4.0665645789517156e-05), ('m', 2.5416028618448222e-06)], 'p': [('e', 0.006450588063362159), ('a', 0.003051194235644709), ('s', 0.0030486526327828645), ('t', 0.0028567616167135806), ('u', 0.00197101301936066), ('m', 0.0019544926007586685), ('n', 0.0010179119461688514), ('r', 0.0007561268513988347), ('p', 0.0006620875455105763), ('o', 0.0005578818281749385), ('i', 0.00047019652944129217), ('x', 0.0003469287906418183), ('l', 0.0003024507405595339), ('d', 7.751888728626708e-05), ('c', 5.845686582243091e-05), ('z', 4.829045437505163e-05), ('y', 3.812404292767234e-05), ('g', 1.1437212878301701e-05), ('q', 7.624808585534467e-06), ('h', 5.0832057236896445e-06), ('f', 5.0832057236896445e-06)], 'i': [('a', 0.0233166646545644), ('u', 0.00758922614546864), ('t', 0.006258697047292875), ('r', 0.005614400721815213), ('o', 0.005350074024183351), ('s', 0.004774400975975499), ('d', 0.003166837165858649), ('l', 0.002960967334049218), ('e', 0.0029037812696577096), ('m', 0.0025225408403809864), ('v', 0.002048531906646927), ('n', 0.002024386679459401), ('f', 0.001603751405824083), ('c', 0.00139661077258373), ('p', 0.0010903476277314289), ('b', 0.0008971858102312223), ('h', 0.000623963502582904), ('g', 0.0004155520679116285), ('i', 0.00020205742751666338), ('x', 0.00018426620748374962), ('z', 8.641449730272396e-05), ('k', 3.5582440065827514e-05), ('w', 3.8124042927672336e-06), ('y', 1.2708014309224111e-06), ('j', 1.2708014309224111e-06)], 's': [('e', 0.029219537301199), ('i', 0.009284475254319136), ('s', 0.007758242735781321), ('n', 0.006469650084825996), ('u', 0.0060007243568156255), ('a', 0.005283992349775386), ('r', 0.004423659781040913), ('t', 0.00423176876497163), ('l', 0.00218196605689378), ('o', 0.0013178210838665405), ('p', 0.0005210285866781885), ('d', 0.0005172161823854214), ('c', 0.0002795763148029305), ('x', 0.00020968223610219784), ('b', 0.00014360056169423246), ('y', 0.0001232677387994739), ('g', 6.73524758388878e-05), ('f', 6.226927011519815e-05), ('m', 2.7957631480293048e-05), ('h', 1.906202146383617e-05), ('z', 1.7791220032913757e-05), ('q', 7.624808585534467e-06)], 't': [('n', 0.017572642186795103), ('i', 0.01681397373253442), ('e', 0.015465653414325745), ('u', 0.005440300925778843), ('s', 0.0043677445180803276), ('a', 0.004309287652257896), ('t', 0.0036700745325039235), ('r', 0.0032303772374047694), ('o', 0.0010928892305932737), ('c', 0.0005731314453460074), ('l', 0.0003177003577306028), ('p', 0.0002795763148029305), ('x', 0.0002274734561351116), ('g', 0.00021349464039496508), ('y', 4.9561255805974034e-05), ('z', 3.049923434213787e-05), ('d', 3.049923434213787e-05), ('b', 2.7957631480293048e-05), ('m', 1.2708014309224112e-05), ('h', 1.1437212878301701e-05), ('f', 5.0832057236896445e-06), ('q', 1.2708014309224111e-06)], 'o': [('c', 0.00664629148372421), ('s', 0.005752918077785755), ('r', 0.004748984947357051), ('t', 0.004033523741747733), ('p', 0.0039115268043791816), ('v', 0.003056277441368399), ('l', 0.002864386425299115), ('m', 0.002753826700808865), ('n', 0.002404356307305202), ('b', 0.002283630171367573), ('d', 0.0019506801964659013), ('i', 0.001918910160692841), ('f', 0.0018769737134724013), ('h', 0.0014703172555772298), ('j', 0.0010344323647708427), ('e', 0.0009073522216786016), ('g', 0.0006328591125993608), ('u', 0.0006290467083065936), ('a', 8.133129157903431e-05), ('y', 7.116488013165503e-05), ('x', 5.9727667253353325e-05), ('z', 3.812404292767234e-05), ('o', 7.624808585534467e-06), ('q', 5.0832057236896445e-06), ('k', 1.2708014309224111e-06)], 'e': [('l', 0.02356828333788704), ('d', 0.021142323406256155), ('r', 0.021078783334710034), ('t', 0.014639632484226178), ('s', 0.014105895883238765), ('n', 0.012489436463105458), ('i', 0.011807016094700123), ('m', 0.008741843043315267), ('u', 0.0070199071044154), ('c', 0.006858515322688254), ('e', 0.006524294546355659), ('v', 0.0047909213945774905), ('h', 0.004682903272949086), ('p', 0.004112313430464923), ('g', 0.0035035995450530878), ('b', 0.0016202718244260742), ('f', 0.0014232976026331006), ('j', 0.0014156727940475662), ('y', 0.0007980632986192743), ('a', 0.0005782146510696971), ('x', 0.00039394844358594746), ('o', 0.000271951506217396), ('z', 0.000157579377434379), ('k', 1.7791220032913757e-05), ('q', 3.8124042927672336e-06)], 'u': [('o', 0.015291553618289374), ('e', 0.010041872907148893), ('q', 0.010032977297132437), ('a', 0.006524294546355659), ('d', 0.0037132817811552856), ('s', 0.003208773613079088), ('l', 0.003099484690019761), ('t', 0.002404356307305202), ('r', 0.0016787286902485053), ('p', 0.001245385402303963), ('c', 0.00121742777082367), ('n', 0.0011665957135867735), ('f', 0.0007713764685699036), ('g', 0.0006747955598198004), ('m', 0.0006137970911355246), ('j', 0.0005451738138657144), ('h', 0.00039903164930963714), ('u', 0.0003316791734707493), ('b', 0.00029990913769768903), ('v', 0.000157579377434379), ('i', 9.022690159549119e-05), ('x', 3.5582440065827514e-05), ('z', 1.6520418601991345e-05), ('y', 1.2708014309224111e-06)], 'n': [('e', 0.023098086808445745), ('o', 0.012541539321773276), ('a', 0.012082780005210287), ('i', 0.008462266728512337), ('u', 0.006829286889777038), ('n', 0.003164295562996804), ('g', 0.0010547651876656014), ('r', 0.0010102871375833168), ('s', 0.0009073522216786016), ('l', 0.0006074430839809125), ('t', 0.00033294997490167173), ('x', 6.481087297704297e-05), ('z', 4.0665645789517156e-05), ('h', 2.6686830049370635e-05), ('m', 2.5416028618448223e-05), ('d', 2.2874425756603402e-05), ('c', 2.160362432568099e-05), ('y', 5.0832057236896445e-06), ('f', 5.0832057236896445e-06), ('p', 3.8124042927672336e-06), ('b', 1.2708014309224111e-06)], 'd': [('e', 0.008744384646177111), ('n', 0.0064239012333127885), ('t', 0.005694461211963325), ('s', 0.005611859118953368), ('r', 0.003553160800859062), ('a', 0.0018693489048868669), ('i', 0.0017498935703801602), ('u', 0.0016545834630609794), ('l', 0.0006201510982901367), ('x', 0.0003901360392931802), ('d', 0.0003049923434213787), ('o', 0.00017155819317452552), ('p', 0.00016520418601991346), ('c', 0.00016393338458899106), ('m', 0.00012072613593762907), ('g', 8.895610016456878e-05), ('z', 8.387289444087914e-05), ('y', 8.133129157903431e-05), ('f', 2.7957631480293048e-05), ('k', 6.354007154612056e-06), ('h', 3.8124042927672336e-06), ('b', 2.5416028618448222e-06), ('q', 2.5416028618448222e-06), ('v', 1.2708014309224111e-06)], 'c': [('e', 0.008660511751736233), ('a', 0.004257184793590078), ('n', 0.004071647784675406), ('s', 0.003850528335694906), ('t', 0.0022569433413182024), ('r', 0.0017359147546400137), ('u', 0.0016342506401662209), ('i', 0.0012364897922875061), ('o', 0.0007701056671389812), ('c', 0.0006366715168921281), ('x', 0.00039394844358594746), ('l', 0.00035328279779643033), ('d', 0.00010293491590471531), ('p', 5.337366009874127e-05), ('h', 4.0665645789517156e-05), ('y', 3.304083720398269e-05), ('q', 2.9228432911215456e-05), ('z', 2.2874425756603402e-05), ('m', 1.5249617171068934e-05), ('g', 1.5249617171068934e-05), ('f', 6.354007154612056e-06), ('v', 2.5416028618448222e-06)], 'b': [('e', 0.002502208017486228), ('a', 0.0019392429835875995), ('m', 0.0013457787153468336), ('s', 0.0011399088835374028), ('i', 0.0005782146510696971), ('t', 0.000559152629605861), ('u', 0.0005261117924018783), ('n', 0.0005121329766617317), ('r', 0.00047019652944129217), ('o', 0.00032151276202337006), ('x', 0.00017282899460544792), ('l', 0.00013216334881593076), ('h', 5.337366009874127e-05), ('c', 2.4145227187525814e-05), ('z', 2.160362432568099e-05), ('p', 2.160362432568099e-05), ('b', 1.6520418601991345e-05), ('d', 7.624808585534467e-06), ('g', 3.8124042927672336e-06), ('y', 3.8124042927672336e-06), ('q', 1.2708014309224111e-06), ('f', 1.2708014309224111e-06)], 'v': [('a', 0.005478424968706515), ('e', 0.004398243752422465), ('u', 0.0023713154701012194), ('i', 0.001087806024869584), ('s', 0.0008679573773200069), ('n', 0.0007929800928955845), ('t', 0.0005045081680761972), ('r', 0.0004562177137011456), ('l', 0.00016647498745083587), ('z', 0.0001232677387994739), ('x', 5.337366009874127e-05), ('o', 5.210285866781886e-05), ('d', 2.4145227187525814e-05), ('c', 2.4145227187525814e-05), ('y', 2.160362432568099e-05), ('p', 7.624808585534467e-06), ('h', 7.624808585534467e-06), ('v', 6.354007154612056e-06), ('f', 3.8124042927672336e-06), ('m', 2.5416028618448222e-06)], 'l': [('e', 0.012583475768993716), ('i', 0.010838665404337245), ('l', 0.006934763408543598), ('a', 0.00569700281482517), ('t', 0.005276367541189851), ('s', 0.00451134507977456), ('r', 0.003340936961895019), ('u', 0.002779242729427313), ('p', 0.0023586074557919953), ('b', 0.001668562278801126), ('o', 0.0014296516097877126), ('n', 0.001211073763669058), ('c', 0.0010090163361523945), ('f', 0.000723086014194852), ('g', 0.00042444767792808536), ('x', 0.00021349464039496508), ('z', 0.0001461421645560773), ('d', 0.00014232976026331006), ('m', 2.6686830049370635e-05), ('h', 2.4145227187525814e-05), ('y', 1.5249617171068934e-05), ('v', 1.2708014309224112e-05), ('k', 1.2708014309224111e-06)], 'h': [('c', 0.006036306796881453), ('a', 0.0009327682502970498), ('e', 0.0008857485973529206), ('s', 0.0006595459426487314), ('t', 0.0005515278210203265), ('n', 0.0003393039820562838), ('l', 0.00031007554914506833), ('d', 0.00022111944898049954), ('p', 0.00019189101606928408), ('x', 0.0001385173559705428), ('m', 0.00011055972449024977), ('r', 0.00010547651876656014), ('o', 8.260209300995673e-05), ('u', 6.099846868427574e-05), ('i', 4.9561255805974034e-05), ('f', 1.6520418601991345e-05), ('q', 1.3978815740146524e-05), ('g', 8.895610016456878e-06), ('z', 1.2708014309224111e-06), ('y', 1.2708014309224111e-06)], 'j': [('e', 0.0013025714666954715), ('s', 0.0005578818281749385), ('u', 0.0004829045437505163), ('t', 0.00034438718777997346), ('n', 0.0003062631448523011), ('a', 0.0002872011233884649), ('i', 0.0001817246046219048), ('r', 0.0001258093416613187), ('x', 6.86232772698102e-05), ('l', 4.829045437505163e-05), ('d', 4.0665645789517156e-05), ('h', 2.0332822894758578e-05), ('c', 1.6520418601991345e-05), ('z', 1.2708014309224112e-05), ('o', 1.1437212878301701e-05), ('p', 6.354007154612056e-06), ('b', 5.0832057236896445e-06), ('f', 5.0832057236896445e-06), ('m', 3.8124042927672336e-06), ('q', 2.5416028618448222e-06), ('g', 1.2708014309224111e-06), ('y', 1.2708014309224111e-06)], 'a': [('l', 0.015052642949275961), ('t', 0.009726714152280136), ('s', 0.009142145494055827), ('r', 0.008519452792903845), ('p', 0.006137970911355246), ('m', 0.00547588336584467), ('v', 0.005460633748673601), ('e', 0.005346261619890584), ('d', 0.004600301179939129), ('n', 0.004501178668327181), ('c', 0.003438788672076045), ('h', 0.0032125860173718556), ('f', 0.002391648292995978), ('u', 0.0019290765721402202), ('b', 0.001702873917436031), ('g', 0.0014995456884884452), ('i', 0.0012733430337842561), ('y', 0.0009594550803464205), ('j', 0.0008260209300995673), ('x', 0.0003901360392931802), ('a', 0.0002960967334049218), ('z', 0.0002147654418258875), ('q', 1.7791220032913757e-05), ('k', 7.624808585534467e-06), ('w', 7.624808585534467e-06), ('o', 3.8124042927672336e-06)], 'g': [('a', 0.002459000768834866), ('e', 0.0022022988797885386), ('n', 0.0019722838207915823), ('i', 0.0011132220534880322), ('s', 0.0007980632986192743), ('r', 0.000695128382714559), ('u', 0.000494341756628818), ('t', 0.00025797269047724946), ('o', 0.0002160362432568099), ('l', 0.00020332822894758579), ('x', 7.370648299349985e-05), ('m', 3.812404292767234e-05), ('g', 2.9228432911215456e-05), ('p', 2.160362432568099e-05), ('d', 1.3978815740146524e-05), ('z', 1.1437212878301701e-05), ('y', 6.354007154612056e-06), ('c', 3.8124042927672336e-06), ('q', 3.8124042927672336e-06), ('h', 1.2708014309224111e-06)], 'f': [('e', 0.0029940081712532007), ('a', 0.0014487136312515488), ('n', 0.0013406955096231439), ('s', 0.001158970905001239), ('f', 0.0011348256778137133), ('u', 0.0009213310374187482), ('t', 0.0005324657995564903), ('i', 0.00042190607506624055), ('l', 0.00033422077633259417), ('r', 0.00021857784611865473), ('o', 0.00017155819317452552), ('x', 0.00016520418601991346), ('d', 3.049923434213787e-05), ('p', 1.6520418601991345e-05), ('c', 1.3978815740146524e-05), ('y', 1.1437212878301701e-05), ('g', 1.0166411447379289e-05), ('q', 6.354007154612056e-06), ('z', 5.0832057236896445e-06), ('h', 2.5416028618448222e-06)], 'q': [('s', 0.0024335847402164176), ('e', 0.0023128586042787886), ('t', 0.0014169435954784885), ('a', 0.0009035398173858343), ('n', 0.0008387289444087914), ('i', 0.0007548560499679122), ('r', 0.0005146745795235765), ('u', 0.00037869882641487854), ('l', 0.00027576391051016325), ('x', 0.00011055972449024977), ('o', 8.768529873364638e-05), ('d', 3.5582440065827514e-05), ('z', 2.7957631480293048e-05), ('c', 2.7957631480293048e-05), ('p', 1.5249617171068934e-05), ('f', 7.624808585534467e-06), ('m', 5.0832057236896445e-06), ('h', 5.0832057236896445e-06), ('g', 3.8124042927672336e-06), ('b', 2.5416028618448222e-06), ('v', 1.2708014309224111e-06)], 'x': [('u', 0.0029025104682267873), ('i', 0.0005972766725335333), ('e', 0.0005502570195894041), ('n', 1.1437212878301701e-05), ('y', 6.354007154612056e-06), ('r', 2.5416028618448222e-06), ('s', 1.2708014309224111e-06)], 'y': [('o', 0.0006658999498033435), ('a', 0.0004155520679116285), ('l', 0.00038124042927672336), ('s', 0.0003736156206911889), ('n', 0.00019443261893112892), ('u', 7.87896887171895e-05), ('e', 5.0832057236896447e-05), ('r', 3.43116386349051e-05), ('t', 3.177003577306028e-05), ('d', 2.0332822894758578e-05), ('h', 1.7791220032913757e-05), ('m', 1.1437212878301701e-05), ('j', 1.0166411447379289e-05), ('x', 6.354007154612056e-06), ('z', 3.8124042927672336e-06), ('i', 2.5416028618448222e-06), ('v', 1.2708014309224111e-06)], 'k': [('s', 1.3978815740146524e-05), ('o', 1.2708014309224112e-05), ('x', 1.2708014309224112e-05), ('c', 1.1437212878301701e-05), ('n', 7.624808585534467e-06), ('e', 6.354007154612056e-06), ('h', 2.5416028618448222e-06), ('l', 1.2708014309224111e-06), ('a', 1.2708014309224111e-06)], 'w': [('r', 5.0832057236896445e-06), ('n', 2.5416028618448222e-06), ('s', 2.5416028618448222e-06), ('e', 1.2708014309224111e-06)]}

DBLref= {'e': 0.006524294546355659, 'm': 0.0026877450264008998, 'i': 0.00020205742751666338, 'l': 0.006934763408543598, 'z': 0, 'o': 7.624808585534467e-06, 'a': 0.0002960967334049218, 'g': 2.9228432911215456e-05, 'r': 0.0024081687115979694, 'n': 0.003164295562996804, 'p': 0.0006620875455105763, 't': 0.0036700745325039235, 'd': 0.0003049923434213787, 's': 0.007758242735781321, 'u': 0.0003316791734707493, 'b': 1.6520418601991345e-05, 'c': 0.0006366715168921281, 'h': 0, 'v': 6.354007154612056e-06, 'x': 0, 'k': 0, 'y': 0, 'q': 0, 'f': 0.0011348256778137133, 'j': 0, 'w': 0}

def print_frequences (F):
    """
    list[tuple[str,float]] -> NoneType
    Affiche les fréquences en ordre décroissant.
    """
    nb=0
    debut=True
    for (lettre, frequence) in F:
        if nb%8==0 and not(debut):
            print()
        print ("%s: %.3f" % (lettre,frequence), end=' ')
        nb+=1
        debut=False
    print('\n')

def print_frequence_bigrammes(c,FBL,FBR,DBL):    
    """
    dict[str:list[tuple[str,float]]]*dict[str:list[tuple[str,float]]] -> NoneType
    Affiche les fréquences des bigrammes en ordre décroissant.
    """
    print('Fréquences des bigrammes %s?' % c)
    for (lettre, frequence) in FBL[c]:
         print ("%s: %.2g" % (lettre,frequence), end=' ')
    print('\nFréquences des bigrammes ?%s' % c)
    for (lettre, frequence) in FBR[c]:
         print ("%s: %.2g" % (lettre,frequence), end=' ')
    print('\nFréquence de caractère doublé %.2g\n' % DBL[c])

def initialise_substitution():
    """
    NoneType -> dict[str:str]
    Initialise la substitution avec l'identité.
    """
    S=dict()
    for c in ALPHABET:
        S[c]=c
    return S

def print_res_substitution(S,text):
    """
    dict[str:str]*str -> Nonetype
    Affiche le résultat de l'application de la substitution S au text 
    """
    s=""
    for c in text:
        s=s+S[c]
    print(s)

def print_red(s):
    print ('\033[1;31;40m'+s+'\033[0m')

def print_res_substitution_colore(S,text,c):
    """
    dict[str:str]*str -> Nonetype
    Affiche le résultat de l'application de la substitution S au text 
    """
    s=""
    for l in text:
        if S[l]==c:
            s=s+'\033[1;31;40m'+c+'\033[0m'
        else:
            s=s+S[l]
    print(s)

def print_etat_substitution(S):
    """
    dict[str:str] -> NoneType
    Affiche la substitution déjà réalisée, les lettres non substituées, les lettres non attribuées
    """
    lns=[]
    sdr=[]
    lda=[]
    ldna=[]
    for C in ALPHABET:
        if S[C]==C:
            lns.append(C)
        else:
            sdr.append(C+'->'+S[C])
            lda.append(S[C])
    for c in alphabet:
        if c not in lda:
            ldna.append(c)
    print ('Substitution déjà réalisée:')
    print (', '.join(sdr))
    print ('Lettres non substituées:')
    print (', '.join(lns))
    print ('Lettres non attribuées:')
    print (', '.join(ldna))


def somme(L):
    """
    list(Number) -> Number
    Calcule la somme des éléments de la liste L.
    """
    s=0
    for e in L:
        s+=e
    return s

def snd(c):
    """ 
    tuple[alpha,beta]->beta
    renvoie le second élément d'un tuple.
    """
    return c[1]

# Global
# if sys.argc != 1:
#     print("Usage: python3 cryptanalyse_subst.py <fichier>")
#     exit(1)
try:
    in_file = open(sys.argv[1], "r")
except:
    sys.exit("ERROR. Can't read supplied filename.")
cypher = in_file.read().replace('\n','')
in_file.close()

# Pour le texte chiffré 
# fréquence des caracteres
# fréquence des bigrammes
F=frequence(cypher)
(DFBR,FBR,FBL,DBL)=frequence_bigrammes(cypher)
# pour le texte de référence résultats stockés plus haut

def print_explications_heuristique():
    print()
    print_red (
        """                         Heuristique proposée ici                               

Identifier 'e': le caractère le plus fréquent

Identifier 'qu': quasiment 1 seul caractère qui suit un caractère peu fréquent

Identifier les voyelles 'a,e,i,o,u': 
    les caractères les moins doublés parmi les 10 plus fréquents,
    ceux qui sont avant ou après le plus de caractères différents(*)
On a déjà identifié 'e' et 'u', on identifie donc 'a,i,o'
    o est sans doute la voyelle parmi 'a,i,o' la moins fréquente

Les 5 autres caractères les plus fréquents sont sans doute 'l,n,r,s,t'
    'l,r' sont les deux caractères parmi 'l,n,r,s,t' qui sont les moins
    fréquemment appairées avec un autre caractère de la liste
""")

def heuristique():
    """
    NoneType -> NoneType
    Affiche les informations les plus plausibles pour le texte courant compte tenu de la langue. 
    """
    (cE,fCE)=F[0]
    RSTLN=list()
    voyelles=list()
    for (c,fc) in F[1:10]:
        if DBL[c]/fc >= 0.025:
            RSTLN.append((c,fc))
        else:
            voyelles.append((c,fc))
    m=FBR[F[0][0]][0][1]/somme([fcar for (car,fcar) in FBR[F[0][0]][1:]])
    for (c,fc) in F:
        s=somme([fcar for (car,fcar) in FBR[c][1:]])
        if s>0 and FBR[c][0][1]/s > m:
            cQ=c
            (cU,fcU)=FBR[c][0]
            m=FBR[c][0][1]/s
    (cO,fcO)=voyelles[0]
    for (c,fc) in voyelles:
        if c != cU and fc < fcO:
            (cO,fcO)=(c,fc)
    AI=[]
    for (c,fc) in voyelles:
        if c!=cU and c!=cO:
            AI.append(c)
    L=sorted([(c,somme([DFBR[c][c2] for (c2,fc2) in RSTLN if c2 in DFBR[c]])) for (c,fc) in RSTLN],key=snd)
    LR=L[0:2]
    STN=L[2:5]
    print('Heuristique')
    print('e=%s q=%s u=%s o=%s' % (cE, cQ, cU, cO))
    print('{a,i}=', AI, '{l,r}=', [c for (c,fc) in LR], '{s,t,n}=', [c for (c,fc) in STN]) 

def instructions():
    """ 
    NoneType -> NoneType
    """
    print_red ("""  'q' pour quitter,
  'c' pour afficher le texte initial,
  'd' pour afficher le texte en cours de substitution,
  'p<car_a_colorier>',
  '=<car_a_substituer><car_de_substitution>',
  'u<car_a_desubtituer>' pour annuler une substitution douteuse,
  'b<C>'  infos sur les bigrammes pour le caractère <c> dans le texte
  'B<c>'  infos sur les bigrammes pour le caractère <C> dans le texte de réf
  'h'   heuristique
  'hh'  explications heuristique
  """)
    
def interface():
    """ 
    NoneType -> NoneType
    """
    print ("Substitution mono-alphabétique".center(80))
    print()
    S=initialise_substitution()
    print('Fréquence des caractères du texte')
    print_frequences(F)
    print('Fréquence des caractères de la langue')
    print_frequences(Fref)
    print_etat_substitution (S)
    print("Taper 'i' pour instructions")
    mot = input("Opération à effectuer ('i' pour instructions) ")
    while mot != 'q':
        if mot=='i':
            instructions()
        elif mot=='c':
            print(cypher)
        elif mot=='d':
            print_res_substitution(S,cypher)
        elif mot=='h':
            heuristique()
        elif len(mot)==3 and mot[0]=='=':
            S[mot[1]]=mot[2]
            print_res_substitution(S,cypher)
        elif len(mot)==2 and mot[0]=='u':
            S[mot[1]]=mot[1]
            print_res_substitution(S,cypher)
        elif len(mot)==2 and mot[0]=='p':
            print_res_substitution_colore(S,cypher,mot[1])
        elif len(mot)==2 and mot[0]=='b':
            print_frequence_bigrammes(mot[1],FBR,FBL,DBL)
        elif len(mot)==2 and mot[0]=='B':
            print_frequence_bigrammes(mot[1],FBRref,FBLref,DBLref)
        elif mot=="hh":
            print_explications_heuristique()
        mot = input("Opération à effectuer ('i' pour instructions) ")
        print('Fréquence des caractères du texte')
        print_frequences(F)
        print('Fréquence des caractères de la langue')
        print_frequences(Fref)
        print_etat_substitution (S)

interface()
